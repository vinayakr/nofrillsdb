# Local admin
local   all             all                                     trust

# Reject non-TLS
hostnossl all           all             0.0.0.0/0               reject
hostnossl all           all             ::/0                    reject

# -----------------------------------------
# PASSWORD AUTH — ONLY from PgBouncer network
# -----------------------------------------
# (Docker compose default bridge network is usually 172.18.0.0/16 in your logs)
hostssl  all            all             172.18.0.0/16           scram-sha-256

# -----------------------------------------
# CERT AUTH — everyone else (direct clients)
# -----------------------------------------
hostssl  all            all             0.0.0.0/0               cert clientcert=verify-full
hostssl  all            all             ::/0                    cert clientcert=verify-full